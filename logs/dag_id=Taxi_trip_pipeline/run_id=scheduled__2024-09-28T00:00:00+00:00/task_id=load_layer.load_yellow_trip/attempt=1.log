[2024-09-29T20:35:14.999+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-09-29T20:35:15.020+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Taxi_trip_pipeline.load_layer.load_yellow_trip scheduled__2024-09-28T00:00:00+00:00 [queued]>
[2024-09-29T20:35:15.029+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Taxi_trip_pipeline.load_layer.load_yellow_trip scheduled__2024-09-28T00:00:00+00:00 [queued]>
[2024-09-29T20:35:15.029+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-09-29T20:35:15.041+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): load_layer.load_yellow_trip> on 2024-09-28 00:00:00+00:00
[2024-09-29T20:35:15.048+0000] {standard_task_runner.py:63} INFO - Started process 192 to run task
[2024-09-29T20:35:15.051+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'Taxi_trip_pipeline', 'load_layer.load_yellow_trip', 'scheduled__2024-09-28T00:00:00+00:00', '--job-id', '12', '--raw', '--subdir', 'DAGS_FOLDER/taxi_trip.py', '--cfg-path', '/tmp/tmp4jl35_7d']
[2024-09-29T20:35:15.053+0000] {standard_task_runner.py:91} INFO - Job 12: Subtask load_layer.load_yellow_trip
[2024-09-29T20:35:15.098+0000] {task_command.py:426} INFO - Running <TaskInstance: Taxi_trip_pipeline.load_layer.load_yellow_trip scheduled__2024-09-28T00:00:00+00:00 [running]> on host c117e05af260
[2024-09-29T20:35:15.175+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Mahmoud' AIRFLOW_CTX_DAG_ID='Taxi_trip_pipeline' AIRFLOW_CTX_TASK_ID='load_layer.load_yellow_trip' AIRFLOW_CTX_EXECUTION_DATE='2024-09-28T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-09-28T00:00:00+00:00'
[2024-09-29T20:35:15.176+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-09-29T20:35:17.555+0000] {taxi_trip.py:83} INFO - Loading yellow trip data started with 2964624 rows
[2024-09-29T20:35:17.555+0000] {Load_data.py:46} INFO - Loading yellow trip data...
[2024-09-29T20:35:17.556+0000] {Load_data.py:47} INFO - yellow  trip with 2964624rows
[2024-09-29T20:35:19.023+0000] {db_utils.py:31} INFO - Loading data into table yellow_trip...
[2024-09-29T20:35:19.029+0000] {db_utils.py:16} INFO - Connected to PostgreSQL database successfully
[2024-09-29T20:37:00.866+0000] {db_utils.py:40} ERROR - Error while inserting data into table yellow_trip: (psycopg2.errors.UndefinedColumn) column "VendorID" of relation "yellow_trip" does not exist
LINE 1: INSERT INTO yellow_trip ("VendorID", tpep_pickup_datetime, t...
                                 ^

[SQL: INSERT INTO yellow_trip ("VendorID", tpep_pickup_datetime, tpep_dropoff_datetime, passenger_count, trip_distance, "RatecodeID", store_and_fwd_flag, "PULocationID", "DOLocationID", payment_type, fare_amount, extra, mta_tax, tip_amount, tolls_amount, improvement_surcharge, total_amount, congestion_surcharge) VALUES (%(VendorID)s, %(tpep_pickup_datetime)s, %(tpep_dropoff_datetime)s, %(passenger_count)s, %(trip_distance)s, %(RatecodeID)s, %(store_and_fwd_flag)s, %(PULocationID)s, %(DOLocationID)s, %(payment_type)s, %(fare_amount)s, %(extra)s, %(mta_tax)s, %(tip_amount)s, %(tolls_amount)s, %(improvement_surcharge)s, %(total_amount)s, %(congestion_surcharge)s)]
[parameters: ({'VendorID': 2, 'tpep_pickup_datetime': datetime.datetime(2024, 1, 1, 0, 57, 55), 'tpep_dropoff_datetime': datetime.datetime(2024, 1, 1, 1, 17, 43), 'passenger_count': 1, 'trip_distance': 1.72, 'RatecodeID': 1, 'store_and_fwd_flag': 'N', 'PULocationID': 186, 'DOLocationID': 79, 'payment_type': 2, 'fare_amount': 17.7, 'extra': 1.0, 'mta_tax': 0.5, 'tip_amount': 0.0, 'tolls_amount': 0.0, 'improvement_surcharge': 1.0, 'total_amount': 22.7, 'congestion_surcharge': 2.5}, {'VendorID': 1, 'tpep_pickup_datetime': datetime.datetime(2024, 1, 1, 0, 3), 'tpep_dropoff_datetime': datetime.datetime(2024, 1, 1, 0, 9, 36), 'passenger_count': 1, 'trip_distance': 1.8, 'RatecodeID': 1, 'store_and_fwd_flag': 'N', 'PULocationID': 140, 'DOLocationID': 236, 'payment_type': 1, 'fare_amount': 10.0, 'extra': 3.5, 'mta_tax': 0.5, 'tip_amount': 3.75, 'tolls_amount': 0.0, 'improvement_surcharge': 1.0, 'total_amount': 18.75, 'congestion_surcharge': 2.5}, {'VendorID': 1, 'tpep_pickup_datetime': datetime.datetime(2024, 1, 1, 0, 17, 6), 'tpep_dropoff_datetime': datetime.datetime(2024, 1, 1, 0, 35, 1), 'passenger_count': 1, 'trip_distance': 4.7, 'RatecodeID': 1, 'store_and_fwd_flag': 'N', 'PULocationID': 236, 'DOLocationID': 79, 'payment_type': 1, 'fare_amount': 23.3, 'extra': 3.5, 'mta_tax': 0.5, 'tip_amount': 3.0, 'tolls_amount': 0.0, 'improvement_surcharge': 1.0, 'total_amount': 31.3, 'congestion_surcharge': 2.5}, {'VendorID': 1, 'tpep_pickup_datetime': datetime.datetime(2024, 1, 1, 0, 36, 38), 'tpep_dropoff_datetime': datetime.datetime(2024, 1, 1, 0, 44, 56), 'passenger_count': 1, 'trip_distance': 1.4, 'RatecodeID': 1, 'store_and_fwd_flag': 'N', 'PULocationID': 79, 'DOLocationID': 211, 'payment_type': 1, 'fare_amount': 10.0, 'extra': 3.5, 'mta_tax': 0.5, 'tip_amount': 2.0, 'tolls_amount': 0.0, 'improvement_surcharge': 1.0, 'total_amount': 17.0, 'congestion_surcharge': 2.5}, {'VendorID': 1, 'tpep_pickup_datetime': datetime.datetime(2024, 1, 1, 0, 46, 51), 'tpep_dropoff_datetime': datetime.datetime(2024, 1, 1, 0, 52, 57), 'passenger_count': 1, 'trip_distance': 0.8, 'RatecodeID': 1, 'store_and_fwd_flag': 'N', 'PULocationID': 211, 'DOLocationID': 148, 'payment_type': 1, 'fare_amount': 7.9, 'extra': 3.5, 'mta_tax': 0.5, 'tip_amount': 3.2, 'tolls_amount': 0.0, 'improvement_surcharge': 1.0, 'total_amount': 16.1, 'congestion_surcharge': 2.5}, {'VendorID': 1, 'tpep_pickup_datetime': datetime.datetime(2024, 1, 1, 0, 54, 8), 'tpep_dropoff_datetime': datetime.datetime(2024, 1, 1, 1, 26, 31), 'passenger_count': 1, 'trip_distance': 4.7, 'RatecodeID': 1, 'store_and_fwd_flag': 'N', 'PULocationID': 148, 'DOLocationID': 141, 'payment_type': 1, 'fare_amount': 29.6, 'extra': 3.5, 'mta_tax': 0.5, 'tip_amount': 6.9, 'tolls_amount': 0.0, 'improvement_surcharge': 1.0, 'total_amount': 41.5, 'congestion_surcharge': 2.5}, {'VendorID': 2, 'tpep_pickup_datetime': datetime.datetime(2024, 1, 1, 0, 49, 44), 'tpep_dropoff_datetime': datetime.datetime(2024, 1, 1, 1, 15, 47), 'passenger_count': 2, 'trip_distance': 10.82, 'RatecodeID': 1, 'store_and_fwd_flag': 'N', 'PULocationID': 138, 'DOLocationID': 181, 'payment_type': 1, 'fare_amount': 45.7, 'extra': 6.0, 'mta_tax': 0.5, 'tip_amount': 10.0, 'tolls_amount': 0.0, 'improvement_surcharge': 1.0, 'total_amount': 64.95, 'congestion_surcharge': 0.0}, {'VendorID': 1, 'tpep_pickup_datetime': datetime.datetime(2024, 1, 1, 0, 30, 40), 'tpep_dropoff_datetime': datetime.datetime(2024, 1, 1, 0, 58, 40), 'passenger_count': 0, 'trip_distance': 3.0, 'RatecodeID': 1, 'store_and_fwd_flag': 'N', 'PULocationID': 246, 'DOLocationID': 231, 'payment_type': 2, 'fare_amount': 25.4, 'extra': 3.5, 'mta_tax': 0.5, 'tip_amount': 0.0, 'tolls_amount': 0.0, 'improvement_surcharge': 1.0, 'total_amount': 30.4, 'congestion_surcharge': 2.5}  ... displaying 10 of 2964624 total bound parameter sets ...  {'VendorID': 2, 'tpep_pickup_datetime': datetime.datetime(2024, 1, 31, 23, 7, 23), 'tpep_dropoff_datetime': datetime.datetime(2024, 1, 31, 23, 25, 14), 'passenger_count': None, 'trip_distance': 3.06, 'RatecodeID': None, 'store_and_fwd_flag': 'None', 'PULocationID': 107, 'DOLocationID': 13, 'payment_type': 0, 'fare_amount': 23.88, 'extra': 0.0, 'mta_tax': 0.5, 'tip_amount': 5.58, 'tolls_amount': 0.0, 'improvement_surcharge': 1.0, 'total_amount': 33.46, 'congestion_surcharge': None}, {'VendorID': 1, 'tpep_pickup_datetime': datetime.datetime(2024, 1, 31, 23, 58, 25), 'tpep_dropoff_datetime': datetime.datetime(2024, 2, 1, 0, 13, 30), 'passenger_count': None, 'trip_distance': 8.1, 'RatecodeID': None, 'store_and_fwd_flag': 'None', 'PULocationID': 138, 'DOLocationID': 75, 'payment_type': 0, 'fare_amount': 32.4, 'extra': 7.75, 'mta_tax': 0.5, 'tip_amount': 7.29, 'tolls_amount': 6.94, 'improvement_surcharge': 1.0, 'total_amount': 55.88, 'congestion_surcharge': None})]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2024-09-29T20:37:00.866+0000] {db_utils.py:25} INFO - PostgreSQL connection is closed
[2024-09-29T20:37:00.867+0000] {db_utils.py:28} INFO - SQLAlchemy engine disposed
[2024-09-29T20:37:00.867+0000] {Load_data.py:74} INFO - Yellow trip data loaded successfully
[2024-09-29T20:37:00.868+0000] {taxi_trip.py:85} INFO - Loading yellow trip data done
[2024-09-29T20:37:00.868+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-09-29T20:37:00.869+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-09-29T20:37:03.168+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=Taxi_trip_pipeline, task_id=load_layer.load_yellow_trip, run_id=scheduled__2024-09-28T00:00:00+00:00, execution_date=20240928T000000, start_date=20240929T203515, end_date=20240929T203703
[2024-09-29T20:37:03.701+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-09-29T20:37:03.724+0000] {taskinstance.py:3498} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-09-29T20:37:03.725+0000] {local_task_job_runner.py:222} INFO - ::endgroup::

[2024-09-29T20:34:51.691+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-09-29T20:34:51.756+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Taxi_trip_pipeline.load_layer.load_green_trip scheduled__2024-09-28T00:00:00+00:00 [queued]>
[2024-09-29T20:34:51.778+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Taxi_trip_pipeline.load_layer.load_green_trip scheduled__2024-09-28T00:00:00+00:00 [queued]>
[2024-09-29T20:34:51.779+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-09-29T20:34:51.819+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): load_layer.load_green_trip> on 2024-09-28 00:00:00+00:00
[2024-09-29T20:34:51.837+0000] {standard_task_runner.py:63} INFO - Started process 160 to run task
[2024-09-29T20:34:51.848+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'Taxi_trip_pipeline', 'load_layer.load_green_trip', 'scheduled__2024-09-28T00:00:00+00:00', '--job-id', '11', '--raw', '--subdir', 'DAGS_FOLDER/taxi_trip.py', '--cfg-path', '/tmp/tmp9019l1hm']
[2024-09-29T20:34:51.858+0000] {standard_task_runner.py:91} INFO - Job 11: Subtask load_layer.load_green_trip
[2024-09-29T20:34:51.968+0000] {task_command.py:426} INFO - Running <TaskInstance: Taxi_trip_pipeline.load_layer.load_green_trip scheduled__2024-09-28T00:00:00+00:00 [running]> on host c117e05af260
[2024-09-29T20:34:52.146+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Mahmoud' AIRFLOW_CTX_DAG_ID='Taxi_trip_pipeline' AIRFLOW_CTX_TASK_ID='load_layer.load_green_trip' AIRFLOW_CTX_EXECUTION_DATE='2024-09-28T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-09-28T00:00:00+00:00'
[2024-09-29T20:34:52.147+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-09-29T20:34:52.444+0000] {taxi_trip.py:70} INFO - Loading green trip data started with 56551 rows
[2024-09-29T20:34:52.444+0000] {Load_data.py:11} INFO - Loading green trip data...
[2024-09-29T20:34:52.445+0000] {Load_data.py:12} INFO - green trip with 56551rows
[2024-09-29T20:34:52.620+0000] {db_utils.py:31} INFO - Loading data into table green_trip...
[2024-09-29T20:34:52.634+0000] {db_utils.py:16} INFO - Connected to PostgreSQL database successfully
[2024-09-29T20:35:02.031+0000] {db_utils.py:40} ERROR - Error while inserting data into table green_trip: (psycopg2.errors.UndefinedColumn) column "VendorID" of relation "green_trip" does not exist
LINE 1: INSERT INTO green_trip ("VendorID", lpep_pickup_datetime, lp...
                                ^

[SQL: INSERT INTO green_trip ("VendorID", lpep_pickup_datetime, lpep_dropoff_datetime, store_and_fwd_flag, "RatecodeID", "PULocationID", "DOLocationID", passenger_count, trip_distance, fare_amount, extra, mta_tax, tip_amount, tolls_amount, ehail_fee, improvement_surcharge, total_amount, payment_type, trip_type, congestion_surcharge) VALUES (%(VendorID)s, %(lpep_pickup_datetime)s, %(lpep_dropoff_datetime)s, %(store_and_fwd_flag)s, %(RatecodeID)s, %(PULocationID)s, %(DOLocationID)s, %(passenger_count)s, %(trip_distance)s, %(fare_amount)s, %(extra)s, %(mta_tax)s, %(tip_amount)s, %(tolls_amount)s, %(ehail_fee)s, %(improvement_surcharge)s, %(total_amount)s, %(payment_type)s, %(trip_type)s, %(congestion_surcharge)s)]
[parameters: ({'VendorID': 2, 'lpep_pickup_datetime': datetime.datetime(2024, 1, 1, 0, 46, 55), 'lpep_dropoff_datetime': datetime.datetime(2024, 1, 1, 0, 58, 25), 'store_and_fwd_flag': 'N', 'RatecodeID': 1, 'PULocationID': 236, 'DOLocationID': 239, 'passenger_count': 1, 'trip_distance': 1.98, 'fare_amount': 12.8, 'extra': 1.0, 'mta_tax': 0.5, 'tip_amount': 3.61, 'tolls_amount': 0.0, 'ehail_fee': None, 'improvement_surcharge': 1.0, 'total_amount': 21.66, 'payment_type': 1, 'trip_type': 1.0, 'congestion_surcharge': 2.75}, {'VendorID': 2, 'lpep_pickup_datetime': datetime.datetime(2024, 1, 1, 0, 31, 42), 'lpep_dropoff_datetime': datetime.datetime(2024, 1, 1, 0, 52, 34), 'store_and_fwd_flag': 'N', 'RatecodeID': 1, 'PULocationID': 65, 'DOLocationID': 170, 'passenger_count': 5, 'trip_distance': 6.54, 'fare_amount': 30.3, 'extra': 1.0, 'mta_tax': 0.5, 'tip_amount': 7.11, 'tolls_amount': 0.0, 'ehail_fee': None, 'improvement_surcharge': 1.0, 'total_amount': 42.66, 'payment_type': 1, 'trip_type': 1.0, 'congestion_surcharge': 2.75}, {'VendorID': 2, 'lpep_pickup_datetime': datetime.datetime(2024, 1, 1, 0, 30, 21), 'lpep_dropoff_datetime': datetime.datetime(2024, 1, 1, 0, 49, 23), 'store_and_fwd_flag': 'N', 'RatecodeID': 1, 'PULocationID': 74, 'DOLocationID': 262, 'passenger_count': 1, 'trip_distance': 3.08, 'fare_amount': 19.8, 'extra': 1.0, 'mta_tax': 0.5, 'tip_amount': 3.0, 'tolls_amount': 0.0, 'ehail_fee': None, 'improvement_surcharge': 1.0, 'total_amount': 28.05, 'payment_type': 1, 'trip_type': 1.0, 'congestion_surcharge': 2.75}, {'VendorID': 1, 'lpep_pickup_datetime': datetime.datetime(2024, 1, 1, 0, 30, 20), 'lpep_dropoff_datetime': datetime.datetime(2024, 1, 1, 0, 42, 12), 'store_and_fwd_flag': 'N', 'RatecodeID': 1, 'PULocationID': 74, 'DOLocationID': 116, 'passenger_count': 1, 'trip_distance': 2.4, 'fare_amount': 14.2, 'extra': 1.0, 'mta_tax': 1.5, 'tip_amount': 0.0, 'tolls_amount': 0.0, 'ehail_fee': None, 'improvement_surcharge': 1.0, 'total_amount': 16.7, 'payment_type': 2, 'trip_type': 1.0, 'congestion_surcharge': 0.0}, {'VendorID': 2, 'lpep_pickup_datetime': datetime.datetime(2024, 1, 1, 0, 32, 38), 'lpep_dropoff_datetime': datetime.datetime(2024, 1, 1, 0, 43, 37), 'store_and_fwd_flag': 'N', 'RatecodeID': 1, 'PULocationID': 74, 'DOLocationID': 243, 'passenger_count': 1, 'trip_distance': 5.14, 'fare_amount': 22.6, 'extra': 1.0, 'mta_tax': 0.5, 'tip_amount': 6.28, 'tolls_amount': 0.0, 'ehail_fee': None, 'improvement_surcharge': 1.0, 'total_amount': 31.38, 'payment_type': 1, 'trip_type': 1.0, 'congestion_surcharge': 0.0}, {'VendorID': 1, 'lpep_pickup_datetime': datetime.datetime(2024, 1, 1, 0, 43, 41), 'lpep_dropoff_datetime': datetime.datetime(2024, 1, 1, 1, 0, 23), 'store_and_fwd_flag': 'N', 'RatecodeID': 1, 'PULocationID': 33, 'DOLocationID': 209, 'passenger_count': 1, 'trip_distance': 2.0, 'fare_amount': 17.0, 'extra': 3.75, 'mta_tax': 1.5, 'tip_amount': 2.0, 'tolls_amount': 0.0, 'ehail_fee': None, 'improvement_surcharge': 1.0, 'total_amount': 24.25, 'payment_type': 1, 'trip_type': 1.0, 'congestion_surcharge': 2.75}, {'VendorID': 1, 'lpep_pickup_datetime': datetime.datetime(2024, 1, 1, 0, 31, 56), 'lpep_dropoff_datetime': datetime.datetime(2024, 1, 1, 0, 48, 9), 'store_and_fwd_flag': 'N', 'RatecodeID': 1, 'PULocationID': 74, 'DOLocationID': 238, 'passenger_count': 2, 'trip_distance': 3.2, 'fare_amount': 18.4, 'extra': 3.75, 'mta_tax': 1.5, 'tip_amount': 4.7, 'tolls_amount': 0.0, 'ehail_fee': None, 'improvement_surcharge': 1.0, 'total_amount': 28.35, 'payment_type': 1, 'trip_type': 1.0, 'congestion_surcharge': 2.75}, {'VendorID': 2, 'lpep_pickup_datetime': datetime.datetime(2024, 1, 1, 0, 46, 12), 'lpep_dropoff_datetime': datetime.datetime(2024, 1, 1, 0, 57, 39), 'store_and_fwd_flag': 'N', 'RatecodeID': 1, 'PULocationID': 166, 'DOLocationID': 239, 'passenger_count': 2, 'trip_distance': 2.01, 'fare_amount': 13.5, 'extra': 1.0, 'mta_tax': 0.5, 'tip_amount': 5.62, 'tolls_amount': 0.0, 'ehail_fee': None, 'improvement_surcharge': 1.0, 'total_amount': 24.37, 'payment_type': 1, 'trip_type': 1.0, 'congestion_surcharge': 2.75}  ... displaying 10 of 56551 total bound parameter sets ...  {'VendorID': 2, 'lpep_pickup_datetime': datetime.datetime(2024, 1, 31, 22, 45), 'lpep_dropoff_datetime': datetime.datetime(2024, 1, 31, 22, 51), 'store_and_fwd_flag': 'None', 'RatecodeID': None, 'PULocationID': 41, 'DOLocationID': 42, 'passenger_count': None, 'trip_distance': 1.17, 'fare_amount': 14.22, 'extra': 0.0, 'mta_tax': 0.0, 'tip_amount': 0.0, 'tolls_amount': 0.0, 'ehail_fee': None, 'improvement_surcharge': 1.0, 'total_amount': 15.22, 'payment_type': None, 'trip_type': None, 'congestion_surcharge': None}, {'VendorID': 2, 'lpep_pickup_datetime': datetime.datetime(2024, 1, 31, 22, 28), 'lpep_dropoff_datetime': datetime.datetime(2024, 1, 31, 22, 59), 'store_and_fwd_flag': 'None', 'RatecodeID': None, 'PULocationID': 33, 'DOLocationID': 91, 'passenger_count': None, 'trip_distance': 9.27, 'fare_amount': 44.62, 'extra': 0.0, 'mta_tax': 0.0, 'tip_amount': 4.56, 'tolls_amount': 0.0, 'ehail_fee': None, 'improvement_surcharge': 1.0, 'total_amount': 50.18, 'payment_type': None, 'trip_type': None, 'congestion_surcharge': None})]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2024-09-29T20:35:02.031+0000] {db_utils.py:25} INFO - PostgreSQL connection is closed
[2024-09-29T20:35:02.061+0000] {db_utils.py:28} INFO - SQLAlchemy engine disposed
[2024-09-29T20:35:02.062+0000] {Load_data.py:39} INFO - Green trip data loaded successfully
[2024-09-29T20:35:02.062+0000] {taxi_trip.py:72} INFO - Loading green trip data done
[2024-09-29T20:35:02.062+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-09-29T20:35:02.063+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-09-29T20:35:02.164+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=Taxi_trip_pipeline, task_id=load_layer.load_green_trip, run_id=scheduled__2024-09-28T00:00:00+00:00, execution_date=20240928T000000, start_date=20240929T203451, end_date=20240929T203502
[2024-09-29T20:35:02.303+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-09-29T20:35:02.332+0000] {taskinstance.py:3498} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-09-29T20:35:02.409+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
